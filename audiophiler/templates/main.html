{% extends "base.html" %}
{% block body %}
    <br>
    <div class="container">
        {% if config['PLUG_SUPPORT'] %}
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <a href="https://plug.csh.rit.edu" title="Advertisements by CSH: Plug" style="color: #000000">
                        Advertisements by CSH: Plug
                    </a>
                </div>
                <div class="panel-body">
                    <div class="plug-body">
                        <a href="https://plug.csh.rit.edu" title="Advertisements by CSH: Plug">
                            <img style="width: 100%" src="https://plug.csh.rit.edu/data"
                                 alt="Advertisements by CSH: Plug">
                        </a>
                    </div>
                </div>
            </div>
        {% endif %}

        {% if (is_rtp or is_eboard) and is_tour_page %}
            {% if is_tour_mode %}
                <div class="col" align="center">
                    <button type="button" class="btn btn-primary" style="margin: 5%;" onclick="toggleTourModeOff()">
                        <span class="glyphicon glyphicon-volume-on"></span>
                        Turn Tour Mode Off
                    </button>
                </div>
            {% else %}
                <div class="col" align="center">
                    <button type="button" class="btn btn-primary" style="margin: 5%;" onclick="toggleTourModeOn()">
                        <span class="glyphicon glyphicon-volume-off"></span>
                        Turn Tour Mode On
                    </button>
                </div>
            {% endif %}
        {% endif %}

        {% for file in db_files %}
            {% if loop.index0 is divisibleby 2 %}
                <div class="row">
            {% endif %}
                <div class="col-xs-12 col-md-6">
                    <div class="panel panel-primary">
                        <div class="panel-heading"></div>
                        <div class="panel-body">
                            <h5 class="title">{{ file.name }}</h5>
                            <audio controls="controls" preload="none" id="audio"
                                   src="{{"/get_file_url/" +  file.file_hash }}"
                                   type="audio/*" download="{{ file.name }}">
                            </audio>
                            <h6>Owner: {{ file.author }} uploaded {{ get_date_modified(s3_bucket, file.file_hash) }}</h6>
                            <div class="form-group">
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox"
                                               data-hash={{ file.file_hash }} {% if file.file_hash in harolds %} checked="checked" {% endif %}
                                               class="toggleHarold"> Toggle Harold
                                    </label>
                                    {% if is_eboard or is_rtp %}
                                        <label>
                                            <input type="checkbox"
                                                data-hash={{ file.file_hash }} {% if file.file_hash in tour_harolds %} checked="checked" {% endif %}
                                                class="toggleTour"> Toggle Tour
                                        </label>
                                    {% endif %}
                                </div>
                                <div class="remove">
                                    {% if file.author == auth_dict["uid"] or is_rtp or is_eboard %}
                                        <button class="glyphicon glyphicon-trash" data-hash={{ file.file_hash }}>Remove
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% if not loop.index0 is divisibleby 2 %}
                </div>
            {% endif %}
        {% endfor %}
        <div class="col" align="center">
            <nav aria-label="page selector">
                <ul class="pagination pagination-lg justify-content-center">
                    {% if page == 1 %}
                    <li class="page-item disabled"> 
                        <a class="page-link" href="{{ current }}/{{ page - 1 }}" tabindex="-1">Previous</a>
                    {% else %}
                    <li class="page-item">
                        <a class="page-link" href="{{ current }}/{{ page - 1 }}">Previous</a>
                    {% endif %}
                    </li>
                    {% if rows <= 12 %}
                        {% for num in range(1, rows + 1) %}
                            <li class="page-item">
                                <a class="page-link" href="{{ current }}{{ num }}">{{ num }}</a>
                            </li>
                        {% endfor %}
                    {% elif page < 6 %}
                        {% for num in range(1, 12) %}
                            <li class="page-item">
                                <a class="page-link" href="{{ current }}/{{ num }}">{{ num }}</a>
                            </li>
                        {% endfor %}
                    {% elif rows - page <= 5 %}
                        {% for num in range(rows - 10, rows + 1) %}
                        <li class="page-item">
                            <a class="page-link" href="{{ current }}/{{ num }}">{{ num }}</a>
                        </li>
                        {% endfor %}
                    {% else %}
                        {% for num in range(page - 5, page + 6) %}
                            <li class="page-item">
                                <a class="page-link" href="{{ current }}/{{ num }}">{{ num }}</a>
                            </li>
                        {% endfor %}
                    {% endif %}
                    {% if page == rows %}
                    <li class="page-item disabled">
                        <a class="page-link" href="{{ current }}/{{ page + 1 }}" tabindex="-1">Next</a>
                    {% else %}
                    <li class="page-item">
                        <a class="page-link" href="{{ current }}/{{ page + 1 }}">Next</a>
                    {% endif %}
                    </li>
                        
                    </li>  
                </ul>
            </nav>
        </div>
    </div>
{% endblock %}
